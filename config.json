{
  "prometheusConfig": {
    "baseUrl": "http://localhost:8428",
    "username": "admin",
    "password": "admin",
    "queryTimeout": "30s",
    "defaultStep": "1m",
    "minStep": "15s"
  },
  "appInstances": [
    {
      "name": "已经废弃",
      "description": "通过prometheus mysql exporter的查询语句获取mysql性能指标",
      "queryTemplates": [
        {
          "metric": "connections",
          "description": "当前连接数",
          "template": "mysql_global_status_connections{{labels}}"
        },
        {
          "metric": "queries_rate",
          "description": "每秒查询数(QPS)",
          "template": "rate(mysql_global_status_questions{{labels}}[1m])"
        },
        {
          "metric": "active_threads",
          "description": "活动线程数",
          "template": "mysql_global_status_threads_connected{{labels}}"
        },
        {
          "metric": "slow_queries",
          "description": "慢查询总数",
          "template": "mysql_global_status_slow_queries{{labels}}"
        },
        {
          "metric": "innodb_buffer_pool_hit_ratio",
          "description": "InnoDB缓冲池命中率(%)",
          "template": "(1 - (mysql_global_status_innodb_buffer_pool_reads{{labels}} / mysql_global_status_innodb_buffer_pool_read_requests{{labels}})) * 100"
        },
        {
          "metric": "innodb_row_lock_time",
          "description": "InnoDB行锁等待时间",
          "template": "mysql_global_status_innodb_row_lock_time{{labels}}"
        },
        {
          "metric": "innodb_row_lock_waits",
          "description": "InnoDB行锁等待次数",
          "template": "mysql_global_status_innodb_row_lock_waits{{labels}}"
        },
        {
          "metric": "table_locks_waited",
          "description": "表级锁等待次数",
          "template": "mysql_global_status_table_locks_waited{{labels}}"
        },
        {
          "metric": "bytes_sent",
          "description": "每秒发送字节数",
          "template": "rate(mysql_global_status_bytes_sent{{labels}}[1m])"
        },
        {
          "metric": "bytes_received",
          "description": "每秒接收字节数",
          "template": "rate(mysql_global_status_bytes_received{{labels}}[1m])"
        },
        {
          "metric": "aborted_connects",
          "description": "失败连接次数",
          "template": "mysql_global_status_aborted_connects{{labels}}"
        },
        {
          "metric": "created_tmp_disk_tables",
          "description": "磁盘临时表创建数",
          "template": "mysql_global_status_created_tmp_disk_tables{{labels}}"
        },
        {
          "metric": "created_tmp_tables",
          "description": "内存临时表创建数",
          "template": "mysql_global_status_created_tmp_tables{{labels}}"
        },
        {
          "metric": "select_full_join",
          "description": "全表JOIN次数",
          "template": "mysql_global_status_select_full_join{{labels}}"
        },
        {
          "metric": "select_full_range_join",
          "description": "范围扫描JOIN次数",
          "template": "mysql_global_status_select_full_range_join{{labels}}"
        },
        {
          "metric": "sort_merge_passes",
          "description": "排序归并次数",
          "template": "mysql_global_status_sort_merge_passes{{labels}}"
        },
        {
          "metric": "sort_range",
          "description": "范围排序次数",
          "template": "mysql_global_status_sort_range{{labels}}"
        },
        {
          "metric": "sort_rows",
          "description": "排序行数",
          "template": "mysql_global_status_sort_rows{{labels}}"
        },
        {
          "metric": "sort_scan",
          "description": "全表扫描排序次数",
          "template": "mysql_global_status_sort_scan{{labels}}"
        }
      ]
    },
    {
      "name": "mysql_analyze",
      "description": "通过prometheus mysql exporter的查询语句获取mysql性能指标",
      "queryTemplates": [
        {
          "metric": "connections",
          "description": "当前连接数",
          "template": "mysql_global_status_threads_connected{{labels}}"
        },
        {
          "metric": "max_connections",
          "description": "最大连接数",
          "template": "mysql_global_variables_max_connections{{labels}}"
        },
        {
          "metric": "connection_usage_ratio",
          "description": "连接使用率(%)",
          "template": "(mysql_global_status_threads_connected{{labels}} / mysql_global_variables_max_connections{{labels}}) * 100"
        },
        {
          "metric": "queries_rate",
          "description": "每秒查询数(QPS)",
          "template": "rate(mysql_global_status_questions{{labels}}[1m])"
        },
        {
          "metric": "slow_queries_rate",
          "description": "每秒慢查询数",
          "template": "rate(mysql_global_status_slow_queries{{labels}}[1m])"
        },
        {
          "metric": "active_threads",
          "description": "活动线程数",
          "template": "mysql_global_status_threads_connected{{labels}}"
        },
        {
          "metric": "running_threads",
          "description": "正在运行的线程数",
          "template": "mysql_global_status_threads_running{{labels}}"
        },
        {
          "metric": "slow_queries",
          "description": "慢查询总数",
          "template": "mysql_global_status_slow_queries{{labels}}"
        },
        {
          "metric": "innodb_buffer_pool_hit_ratio",
          "description": "InnoDB缓冲池命中率(%)",
          "template": "(1 - (rate(mysql_global_status_innodb_buffer_pool_reads{{labels}}[5m]) / rate(mysql_global_status_innodb_buffer_pool_read_requests{{labels}}[5m]))) * 100"
        },
        {
          "metric": "innodb_buffer_pool_usage",
          "description": "InnoDB缓冲池使用率(%)",
          "template": "(mysql_global_status_innodb_buffer_pool_pages_data{{labels}} / mysql_global_status_innodb_buffer_pool_pages_total{{labels}}) * 100"
        },
        {
          "metric": "innodb_row_lock_time_avg",
          "description": "InnoDB平均行锁等待时间(ms)",
          "template": "rate(mysql_global_status_innodb_row_lock_time{{labels}}[1m]) / rate(mysql_global_status_innodb_row_lock_waits{{labels}}[1m])"
        },
        {
          "metric": "innodb_row_lock_waits_rate",
          "description": "每秒InnoDB行锁等待次数",
          "template": "rate(mysql_global_status_innodb_row_lock_waits{{labels}}[1m])"
        },
        {
          "metric": "table_locks_waited_rate",
          "description": "每秒表级锁等待次数",
          "template": "rate(mysql_global_status_table_locks_waited{{labels}}[1m])"
        },
        {
          "metric": "bytes_sent_rate",
          "description": "每秒发送字节数",
          "template": "rate(mysql_global_status_bytes_sent{{labels}}[1m])"
        },
        {
          "metric": "bytes_received_rate",
          "description": "每秒接收字节数",
          "template": "rate(mysql_global_status_bytes_received{{labels}}[1m])"
        },
        {
          "metric": "aborted_connects_rate",
          "description": "每秒失败连接次数",
          "template": "rate(mysql_global_status_aborted_connects{{labels}}[1m])"
        },
        {
          "metric": "aborted_clients_rate",
          "description": "每秒客户端异常断开次数",
          "template": "rate(mysql_global_status_aborted_clients{{labels}}[1m])"
        },
        {
          "metric": "tmp_disk_tables_rate",
          "description": "每秒磁盘临时表创建数",
          "template": "rate(mysql_global_status_created_tmp_disk_tables{{labels}}[1m])"
        },
        {
          "metric": "tmp_tables_rate",
          "description": "每秒内存临时表创建数",
          "template": "rate(mysql_global_status_created_tmp_tables{{labels}}[1m])"
        },
        {
          "metric": "tmp_disk_ratio",
          "description": "磁盘临时表比例(%)",
          "template": "(rate(mysql_global_status_created_tmp_disk_tables{{labels}}[5m]) / rate(mysql_global_status_created_tmp_tables{{labels}}[5m])) * 100"
        },
        {
          "metric": "select_full_join_rate",
          "description": "每秒全表JOIN次数",
          "template": "rate(mysql_global_status_select_full_join{{labels}}[1m])"
        },
        {
          "metric": "select_scan_rate",
          "description": "每秒全表扫描次数",
          "template": "rate(mysql_global_status_select_scan{{labels}}[1m])"
        },
        {
          "metric": "sort_merge_passes_rate",
          "description": "每秒排序归并次数",
          "template": "rate(mysql_global_status_sort_merge_passes{{labels}}[1m])"
        },
        {
          "metric": "key_read_requests_rate",
          "description": "每秒索引读取请求数",
          "template": "rate(mysql_global_status_key_read_requests{{labels}}[1m])"
        },
        {
          "metric": "key_reads_rate",
          "description": "每秒从磁盘读取索引数",
          "template": "rate(mysql_global_status_key_reads{{labels}}[1m])"
        },
        {
          "metric": "key_cache_hit_ratio",
          "description": "索引缓存命中率(%)",
          "template": "(1 - (rate(mysql_global_status_key_reads{{labels}}[5m]) / rate(mysql_global_status_key_read_requests{{labels}}[5m]))) * 100"
        },
        {
          "metric": "query_cache_hit_ratio",
          "description": "查询缓存命中率(%)",
          "template": "(rate(mysql_global_status_qcache_hits{{labels}}[5m]) / (rate(mysql_global_status_qcache_hits{{labels}}[5m]) + rate(mysql_global_status_com_select{{labels}}[5m]))) * 100"
        },
        {
          "metric": "open_files",
          "description": "当前打开文件数",
          "template": "mysql_global_status_open_files{{labels}}"
        },
        {
          "metric": "open_tables",
          "description": "当前打开表数",
          "template": "mysql_global_status_open_tables{{labels}}"
        },
        {
          "metric": "table_open_cache_hit_ratio",
          "description": "表缓存命中率(%)",
          "template": "(rate(mysql_global_status_table_open_cache_hits{{labels}}[5m]) / (rate(mysql_global_status_table_open_cache_hits{{labels}}[5m]) + rate(mysql_global_status_table_open_cache_misses{{labels}}[5m]))) * 100"
        }
      ]
    },
    {
      "name": "redis_analyze",
      "description": "通过prometheus redis exporter的查询语句获取redis性能指标",
      "queryTemplates": [
        {
          "metric": "memory_used",
          "description": "已用内存(bytes)",
          "template": "redis_memory_used_bytes{{labels}}"
        },
        {
          "metric": "memory_fragmentation_ratio",
          "description": "内存碎片率",
          "template": "redis_memory_fragmentation_ratio{{labels}}"
        },
        {
          "metric": "connected_clients",
          "description": "连接客户端数量",
          "template": "redis_connected_clients{{labels}}"
        },
        {
          "metric": "blocked_clients",
          "description": "阻塞客户端数量",
          "template": "redis_blocked_clients{{labels}}"
        },
        {
          "metric": "rejected_connections",
          "description": "拒绝连接次数",
          "template": "redis_rejected_connections_total{{labels}}"
        },
        {
          "metric": "evicted_keys",
          "description": "驱逐键数量",
          "template": "redis_evicted_keys_total{{labels}}"
        },
        {
          "metric": "expired_keys",
          "description": "过期键数量",
          "template": "redis_expired_keys_total{{labels}}"
        },
        {
          "metric": "keyspace_hits",
          "description": "Key命中次数",
          "template": "redis_keyspace_hits_total{{labels}}"
        },
        {
          "metric": "keyspace_misses",
          "description": "Key未命中次数",
          "template": "redis_keyspace_misses_total{{labels}}"
        },
        {
          "metric": "instantaneous_ops_per_sec",
          "description": "每秒操作数(瞬时)",
          "template": "redis_instantaneous_ops_per_sec{{labels}}"
        },
        {
          "metric": "instantaneous_input_kbps",
          "description": "瞬时输入KBps",
          "template": "redis_instantaneous_input_kbps{{labels}}"
        },
        {
          "metric": "instantaneous_output_kbps",
          "description": "瞬时输出KBps",
          "template": "redis_instantaneous_output_kbps{{labels}}"
        },
        {
          "metric": "used_cpu_sys",
          "description": "系统CPU时间",
          "template": "redis_used_cpu_sys{{labels}}"
        },
        {
          "metric": "used_cpu_user",
          "description": "用户CPU时间",
          "template": "redis_used_cpu_user{{labels}}"
        },
        {
          "metric": "used_cpu_sys_children",
          "description": "子进程系统CPU时间",
          "template": "redis_used_cpu_sys_children{{labels}}"
        },
        {
          "metric": "used_cpu_user_children",
          "description": "子进程用户CPU时间",
          "template": "redis_used_cpu_user_children{{labels}}"
        },
        {
          "metric": "connected_slaves",
          "description": "从节点数量",
          "template": "redis_connected_slaves{{labels}}"
        },
        {
          "metric": "repl_backlog_size",
          "description": "复制积压缓冲区大小",
          "template": "redis_repl_backlog_size{{labels}}"
        }
      ]
    }
  ]
}